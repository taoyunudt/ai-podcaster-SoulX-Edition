# SoulX Edition 使用指南

## 🎉 欢迎使用 SoulX Edition

这是基于 SoulX-Podcast 的 AI 播客生成器，支持声音克隆和高保真音频生成。

## ✨ 核心功能

### 1. 🎤 声音克隆
- **零样本声音克隆**：只需上传几秒参考音频即可克隆声音
- **多说话人支持**：最多支持 4 个不同的说话人
- **文本对齐**：为每个声音提供对应的参考文本，提高克隆质量

### 2. 🎵 还原生音频
- **高保真音频**：使用 1.7B 参数的 SoulX-Podcast 模型
- **自然流畅**：支持语调、停顿、情感等细节
- **方言支持**：支持普通话、四川话、河南话、粤语
- **副语言标记**：支持笑声 `<|laughter|>`、叹气 `<|sigh|>` 等情感标记

## 🚀 快速开始

### 前置条件

1. **SoulX-Podcast API 服务运行中**
   ```bash
   cd ~/projects/SoulX-Podcast
   source venv/bin/activate
   python run_api.py --model pretrained_models/SoulX-Podcast-1.7B --port 8000
   ```

2. **启动 ai-podcaster API 服务**
   ```bash
   cd ~/projects/ai-podcaster
   python3 api_server.py
   ```

### 访问应用

**SoulX Edition**:
- 访问地址: http://localhost:8000/soulx
- 功能: 声音克隆 + 还原生音频

**标准版** (千问 TTS):
- 访问地址: http://localhost:8000
- 功能: 文本分析 + 脚本生成 + TTS 音频

## 📝 详细使用流程

### 步骤 1：声音克隆

#### 上传参考音频
1. 在左侧"声音克隆"区域，选择一个声音槽位（说话人 1-4）
2. 点击"选择文件"或拖拽音频文件上传
3. 支持的格式：WAV、MP3、M4A 等

#### 输入参考文本
1. 在"输入参考文本..."框中输入音频对应的文本
2. 确保文本准确对应音频内容
3. 完成后状态会显示"✓ 准备就绪"

#### 重复克隆多个声音
- 可以克隆最多 4 个不同的说话人
- 每个说话人需要独立的音频和文本

#### 生成脚本模板
- 至少克隆 2 个声音后，点击"📝 生成脚本模板"
- 系统会自动创建一个简单的播客开场脚本

### 步骤 2：编辑脚本

#### 脚本格式
使用 `[S1]`、`[S2]`、`[S3]`、`[S4]` 标记不同的说话人：

```
[S1] 欢迎收听本期的播客节目！
[S2] 很高兴能在这里和大家聊天！
[S1] 今天我们来聊聊人工智能的最新发展。
[S2] 确实，最近AI技术发展非常快。
```

#### 支持的情感标记
- `<|laughter|>` - 笑声
- `<|sigh|>` - 叹气
- 其他副语言标记

#### 快捷操作
- **📝 插入示例**：插入预设的示例脚本
- **🗑️ 清空**：清空脚本内容

#### 声音摘要
- 底部显示已克隆的声音（S1、S2 等）
- 帮助你确认哪些声音可以使用

### 步骤 3：生成音频

#### 设置生成参数
- **随机种子**：控制生成的随机性（相同种子 = 相同结果）
- **温度 (0.1-2.0)**：
  - 低值 (0.1-0.3)：更确定、更一致
  - 中值 (0.4-0.7)：平衡（推荐）
  - 高值 (0.8-2.0)：更随机、更多变化
- **Top-K (1-500)**：限制每步采样的词数（推荐 100）
- **Top-P (0.0-1.0)**：核采样参数（推荐 0.9）

#### 生成音频
1. 点击"🎵 生成音频"按钮
2. 等待生成完成（通常 3-10 分钟，取决于对话长度）
3. 生成完成后会自动播放音频

#### 下载音频
- 点击"⬇️ 下载音频"保存到本地
- 文件格式：WAV（高质量）
- 文件命名：podcast_[timestamp].wav

#### 重新生成
- 点击"🔄 重新生成"使用不同的随机种子
- 可以尝试不同的参数组合

## 💡 最佳实践

### 声音克隆建议
1. **音频质量**：
   - 使用清晰、无背景噪音的音频
   - 推荐时长：5-30 秒
   - 推荐采样率：16kHz 或更高

2. **参考文本**：
   - 准确匹配音频内容
   - 避免拼写错误
   - 包含典型的语音特征（停顿、语气）

3. **声音选择**：
   - 选择有明显特征的声音（音高、语速、口音）
   - 男女声搭配效果更好
   - 避免声音过于相似

### 脚本编辑建议
1. **对话长度**：
   - 每轮 10-50 字效果最佳
   - 总对话数建议 4-12 轮
   - 过长可能导致生成时间过长

2. **内容质量**：
   - 保持对话自然流畅
   - 避免过多专业术语
   - 适当使用副语言标记

3. **说话人分配**：
   - 确保脚本中的说话人（S1-S4）都已克隆
   - 合理分配对话比例
   - 避免单个说话人连续过多

### 生成参数调优
1. **温度**：
   - 首次生成使用默认值 0.6
   - 如结果过于随机 → 降低温度
   - 如结果过于重复 → 提高温度

2. **随机种子**：
   - 记录满意的种子值
   - 可以重现高质量结果
   - 尝试不同种子寻找最佳效果

## 🔧 技术细节

### API 端点

**SoulX-Podcast API** (端口 8000):
- `GET /health` - 健康检查
- `POST /generate` - 同步生成音频
- `POST /generate-async` - 异步生成音频
- `GET /task/{task_id}` - 查询任务状态
- `GET /download/{filename}` - 下载音频
- `GET /docs` - API 文档

**ai-podcaster API** (端口 8000):
- `GET /` - 标准版前端
- `GET /soulx` - SoulX Edition 前端
- `GET /health` - 健康检查

### 文件结构
```
ai-podcaster/
├── static/
│   ├── index.html           # 标准版前端
│   ├── index_soulx.html    # SoulX Edition 前端
│   ├── css/
│   │   ├── style.css        # 标准版样式
│   │   └── style_soulx.css # SoulX Edition 样式
│   └── js/
│       ├── app.js           # 标准版逻辑
│       └── app_soulx.js    # SoulX Edition 逻辑
└── api_server.py           # API 服务器
```

### 请求流程

1. **前端** (ai-podcaster/static/js/app_soulx.js)
   - 收集用户输入（声音、脚本、参数）
   - 构造 FormData 请求
   - 调用 SoulX-Podcast API

2. **SoulX-Podcast API** (端口 8000)
   - 接收音频文件和文本
   - 调用模型推理
   - 返回音频文件

3. **前端显示**
   - 播放生成的音频
   - 提供下载功能

## 🐛 常见问题

### Q: 声音克隆不成功
**A:** 检查以下几点：
- 参考音频是否清晰、无噪音
- 参考文本是否准确对应音频内容
- 音频文件格式是否支持（推荐 WAV）

### Q: 生成时间过长
**A:** 取决于以下因素：
- 对话长度：减少对话轮数
- 参数设置：尝试更简单的参数
- 硬件性能：Apple Silicon MPS 已优化

### Q: 音频质量不佳
**A:** 尝试优化：
- 提高参考音频质量
- 准确对应参考文本
- 调整温度参数
- 尝试不同的随机种子

### Q: 无法克隆声音
**A:** 检查：
- 是否至少上传了 1 个音频文件
- 是否填写了对应的参考文本
- 音频文件是否有效

### Q: 脚本中的说话人无法识别
**A:** 确保格式正确：
- 使用 `[S1]`、`[S2]` 等标记
- 标记后添加空格
- 方括号使用英文半角 `[` 和 `]`

## 📊 性能参考

**测试环境**：
- 设备：Apple MacBook Air (M1/M2/M3)
- 内存：16GB
- 模型：SoulX-Podcast 1.7B

**生成时间参考**：
- 4 轮对话：约 6 分钟
- 8 轮对话：约 12 分钟
- 12 轮对话：约 18 分钟

**音频质量**：
- 采样率：24kHz
- 格式：WAV（无损）
- 文件大小：约 0.5-1.5 MB/分钟

## 🔄 版本对比

| 功能 | 标准版 (千问) | SoulX Edition |
|------|---------------|---------------|
| TTS 引擎 | 千问 TTS API | SoulX-Podcast 本地模型 |
| 声音克隆 | 不支持 | ✅ 支持（零样本） |
| 音频质量 | 流畅自然 | 高保真播客风格 |
| 方言支持 | 标准普通话 | ✅ 多方言 |
| 网络依赖 | 需要（API） | 不需要（本地） |
| 成本 | 按量付费 | 免费（开源） |
| 隐私 | 数据上传云端 | ✅ 完全本地 |
| 定制性 | 有限 | ✅ 高度可定制 |

## 📞 技术支持

如遇到问题，请：
1. 查看浏览器控制台错误信息
2. 检查 SoulX-Podcast API 服务状态
3. 参考 SoulX-Podcast 文档：https://github.com/Soul-AILab/SoulX-Podcast

## 🎯 下一步

- 尝试克隆自己的声音
- 创建不同风格的播客脚本
- 探索不同的参数组合
- 对比标准版和 SoulX Edition 的效果

---

**祝你使用愉快！** 🎙️✨
